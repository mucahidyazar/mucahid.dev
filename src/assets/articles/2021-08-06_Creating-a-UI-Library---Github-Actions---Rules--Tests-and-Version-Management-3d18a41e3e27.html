<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Creating a UI Library &amp; Github Actions &amp; Rules, Tests and Version Management</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">Creating a UI Library &amp; Github Actions &amp; Rules, Tests and Version Management</h1>
</header>
<section data-field="subtitle" class="p-summary">
Son 1 aydır npm paketleri ve buradaki yönetim ve best practiselerle alakalı okumalar ve denemeler yapıyordum. Hatta bunları yaparken bir…
</section>
<section data-field="body" class="e-content">
<section name="de06" class="section section--body section--first"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="39fc" id="39fc" class="graf graf--h3 graf--leading graf--title">Creating a UI Library &amp; Github Actions &amp; Rules, Tests and Version Management</h3><p name="4464" id="4464" class="graf graf--p graf-after--h3">Son 1 aydır npm paketleri ve buradaki yönetim ve best practiselerle alakalı okumalar ve denemeler yapıyordum. Hatta bunları yaparken bir tanede kendime ait icomoon-generator adında bir libraryde geliştirdim. Bu librarynin ne iş yaptığına niye oluşturduğuma daha sonra değineceğim. Fakat şimdi gördüğüm, öğrendiğim ve çalıştığım bu şeyleri uygulanan best practiselerle birlikte burada size anlatmaya çalışacağım.</p><figure name="5233" id="5233" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*9tZJmq1VYTIdble0ZgeZRQ.png" data-width="1920" data-height="1080" data-is-featured="true" src="https://cdn-images-1.medium.com/max/800/1*9tZJmq1VYTIdble0ZgeZRQ.png"></figure><h3 name="a5e2" id="a5e2" class="graf graf--h3 graf-after--figure"><strong class="markup--strong markup--h3-strong">What will we see?</strong></h3><p name="33d0" id="33d0" class="graf graf--p graf-after--h3 graf--trailing"><strong class="markup--strong markup--p-strong">1. Create a Github Repo<br>2. Creating the Project<br>3. Storybook<br>4. Prettier<br>5. Eslint<br>6. Button Components with Typescript<br>7. styled-components<br>8. prop-types<br>9. API Design<br>10. Composition API<br>11. Tests (jest Settings)<br>12. Tests (@testing-library/react Settings)<br>13. Tests<br>14. Module Formats<br>15. Typescript Declarations<br>16. husky<br>17. semantic-release<br>18. Github Environment Variable<br>19. Github Actions</strong></p></div></div></section><section name="af8d" class="section section--body section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="5ca4" id="5ca4" class="graf graf--h3 graf--leading">Get Started</h3><h4 name="7eae" id="7eae" class="graf graf--h4 graf-after--h3">Step 1: Create a Github Repo</h4><p name="dc0b" id="dc0b" class="graf graf--p graf-after--h4">Github üzerinde ui-library adında bir repository oluşturdum. Ve oluştururken .gitignore ve Readme.md dosyalarınıda eklemesini istiyorum.</p><figure name="8e0b" id="8e0b" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*pH6H3mVpnymO7zx6ytYtUg.jpeg" data-width="749" data-height="807" src="https://cdn-images-1.medium.com/max/800/1*pH6H3mVpnymO7zx6ytYtUg.jpeg"></figure><h4 name="c9fd" id="c9fd" class="graf graf--h4 graf-after--figure">Step 2: Creating the Project</h4><p name="a277" id="a277" class="graf graf--p graf-after--h4">npx create-react-app ui-library — template typescript</p><p name="047a" id="047a" class="graf graf--p graf-after--p">Yukarıda ki kodu çalıştırarak create-react-app ile typescriptli bir react projesi oluşturuyoruz.</p><p name="d0e5" id="d0e5" class="graf graf--p graf-after--p">Sonra oluşturduğumuz github reposu ile bu oluşturduğumuz projeyi senkronize ediyoruz. Sonra da aşağıdaki gibi package.json dosyamızı kendimize ve oluşturduğumuz repositorye göre bilgilerini düzenliyoruz.</p><figure name="0db9" id="0db9" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/mucahidyazar/7240fb245911163c7f726f41f72b172a.js"></script></figure><p name="cd0b" id="cd0b" class="graf graf--p graf-after--figure">Daha sonra root dizinimize aşağıda ki “tsconfig.json” dosyasını ekliyoruz.</p><figure name="db48" id="db48" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/mucahidyazar/c49937eb216072323f72af4bd4f67ee0.js"></script></figure><p name="7bc1" id="7bc1" class="graf graf--p graf-after--figure">Sonra aşağıda ki gibi file-structure oluşturduktan sonra,</p><figure name="a49f" id="a49f" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*bnxz4xRvRm2dDbo5omNTjQ.png" data-width="150" data-height="189" src="https://cdn-images-1.medium.com/max/800/1*bnxz4xRvRm2dDbo5omNTjQ.png"></figure><p name="095a" id="095a" class="graf graf--p graf--startsWithDoubleQuote graf-after--figure">“Button” componentımı oluşturuyorum.</p><figure name="6201" id="6201" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/mucahidyazar/72083661b777b92d215d430205ffd53f.js"></script><figcaption class="imageCaption">/root/src/ui/Button.tsx</figcaption></figure><figure name="547d" id="547d" class="graf graf--figure graf--iframe graf-after--figure"><script src="https://gist.github.com/mucahidyazar/61840a654f1aecdb47b35c443b3d38f8.js"></script><figcaption class="imageCaption">/root/src/ui/index.ts</figcaption></figure><figure name="a64f" id="a64f" class="graf graf--figure graf--iframe graf-after--figure"><script src="https://gist.github.com/mucahidyazar/bf21b3936a04f2135e1165b5f5901c47.js"></script><figcaption class="imageCaption">/root/src/index.ts</figcaption></figure><h4 name="9684" id="9684" class="graf graf--h4 graf-after--figure">Step 3: Storybook</h4><p name="8608" id="8608" class="graf graf--p graf-after--h4">Ve şimdi de Storybook entegrasyonumuzu yapacağız. Bunun içni tek yapmamız gereken aşağıda ki kodu çalıştırarak projemize storybook’u entegre etmek.</p><p name="395d" id="395d" class="graf graf--p graf-after--p">npx sb init</p><p name="70c9" id="70c9" class="graf graf--p graf-after--p">Kurulumla birlikte gelen “stories” klasörünü proje dışındaki bir dizine taşıyın veya silin. Taşırsanız daha sonra bu örneklere bakıp kopyalar çekebilirsiniz veya direk silip documentationlarlada ilerleyebilirsiniz.</p><p name="a230" id="a230" class="graf graf--p graf-after--p">Sonra “stories” klasorüne gelip “introduction.stories.mdx” adında dosya oluşturuyoruz ve aşağıdakileri içine yapıştırıyoruz.</p><p name="0040" id="0040" class="graf graf--p graf-after--p">import { Meta, Description } from ‘@storybook/addon-docs/blocks’;<br>import README from ‘../../README.md’;<br>&lt;Meta title=”Example/Introduction” /&gt;<br>&lt;Description&gt;{README}&lt;/Description&gt;</p><p name="41ab" id="41ab" class="graf graf--p graf-after--p">Ve daha sonra “Button.stories.tsx” story dosyasını oluşturup aşağıda ki kod blogunu ekliyoruz.</p><figure name="a45d" id="a45d" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/mucahidyazar/5d6696371b7574ba9ac483eb93d5608e.js"></script></figure><p name="9674" id="9674" class="graf graf--p graf-after--figure">Bu yüklemelerden sonra hata alırsanız .storybook dosyasındaki main.js e gelip aşağıda ki typescript blogunu ekleyin.</p><figure name="2ae1" id="2ae1" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/mucahidyazar/95d71b4f5a63912628e5f9c856453b17.js"></script></figure><h4 name="4005" id="4005" class="graf graf--h4 graf-after--figure">Step 4: Prettier</h4><p name="a5ef" id="a5ef" class="graf graf--p graf-after--h4">İlk önce prettieri aşağıdaki gibi yüklüyoruz.</p><p name="5f4e" id="5f4e" class="graf graf--p graf-after--p">yarn add -D prettier</p><p name="f78c" id="f78c" class="graf graf--p graf-after--p">Ve .prettierrc.json adında dosya oluşturup aşağıdaki bir tane ayarı ekliyorum. Siz daha fazla prettier ayarı burada projeniz için ayarlayabilirsiniz tabi ki de.</p><figure name="84a7" id="84a7" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/mucahidyazar/93a29062934d057cb94efe127bcc89a6.js"></script></figure><p name="0d7d" id="0d7d" class="graf graf--p graf-after--figure">Ve package.jsona gelip aşağıda ki 2 tane scripti ekliyoruz. Bunlar;</p><p name="3872" id="3872" class="graf graf--p graf-after--p">- format, prettiere göre dosyaların formatlanmasını düzeltilmesini sağlıyoruz.<br>- lint:format, herşeyin bu formatta olduğunun teyitini yapıyoruz.</p><figure name="1ea4" id="1ea4" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/mucahidyazar/674c85f63029ed32704c711cdc07bc05.js"></script></figure><h4 name="5208" id="5208" class="graf graf--h4 graf-after--figure">Step 5: Eslint</h4><p name="c96c" id="c96c" class="graf graf--p graf-after--h4">Eslint ilede javascript yazım kurallarını set edeceğiz. Aşağıdaki paketleri öncelikle yüklüyoruz.</p><p name="c564" id="c564" class="graf graf--p graf-after--p">npm install — save-dev eslint eslint-config-prettier eslint-plugin-jest eslint-plugin-react eslint-plugin-react-hooks @typescript-eslint/eslint-plugin @typescript-eslint/parser</p><p name="478e" id="478e" class="graf graf--p graf-after--p">or</p><p name="864f" id="864f" class="graf graf--p graf-after--p">yarn add -D eslint eslint-config-prettier eslint-plugin-jest eslint-plugin-react eslint-plugin-react-hooks @typescript-eslint/eslint-plugin @typescript-eslint/parser</p><p name="fe7f" id="fe7f" class="graf graf--p graf-after--p">Sonra <strong class="markup--strong markup--p-strong">“.eslintrc”</strong> adında bir dosya oluşturup içine aşağıdakileri yapıştırıyoruz.</p><figure name="dfed" id="dfed" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/mucahidyazar/3a498963df5f46aa7010de91bf12be75.js"></script></figure><p name="960f" id="960f" class="graf graf--p graf-after--figure">Bu config dosyası;</p><p name="eae6" id="eae6" class="graf graf--p graf-after--p">-root, config dosyasının, root config dosyası olduğunu söyler.<br>-parser, typescriptli eslint rulelarını parse etmesini söyler.<br>-recommend edilen eslint ayarları tanımlanır. <br>-react ve react hookslarının eslint recommended kuralları set edilir.<br>-prettier için eslint ayarlarını set eder.</p><p name="c935" id="c935" class="graf graf--p graf-after--p">Bu eslint kuralları typescriptlerle componentlarımızı tanımlamamızı zorunlu tutacağı için, Button componentımı aşağıda ki gibi düzenliyorum.</p><figure name="2820" id="2820" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/mucahidyazar/61639a37d46f7ca5272232ecce67812c.js"></script></figure><p name="9682" id="9682" class="graf graf--p graf-after--figure">Aşağıda da <strong class="markup--strong markup--p-strong">“lint”</strong> adında yeni bir script tanımlarız. Böylece eslint ile ayarladığımız ayarlarla yazdığımız javascript kolarının kurallara uyup uymadığınız denetleriz.</p><figure name="663b" id="663b" class="graf graf--figure graf--iframe graf--startsWithDoubleQuote graf-after--p"><script src="https://gist.github.com/mucahidyazar/efb7a77732ff49b11364d968efa99228.js"></script><figcaption class="imageCaption">“npm run lint” diyerek çalıştırmayı unutmayın :)</figcaption></figure><h4 name="187f" id="187f" class="graf graf--h4 graf-after--figure">Step 6: Button Components with Typescript</h4><p name="d323" id="d323" class="graf graf--p graf-after--h4">Şimdi de kütüphanemizin ilk gerçek parçası Button componentını gerçek olarak oluşturalım.</p><p name="b3b8" id="b3b8" class="graf graf--p graf-after--p">Button componentımızı React.forwardRef ile sarıyoruz ve generator olarak HTMLButtonElement veriyoruz ve bu buradaki elementin bir HTMLButtonElementi olacağını söylüyor ve 2. Argument olarak da bu generatore propslarin alması gereken attribute kuralları vererek propsları sınırlıyoruz ve onu da React.ComponentsPropsWithoutRef ile &lt;’button’&gt; olmasını söylüyoruz.</p><figure name="9765" id="9765" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/mucahidyazar/f37a717267d34b775f4195e86d7faa5e.js"></script></figure><h4 name="2365" id="2365" class="graf graf--h4 graf-after--figure">Step 7: styled-components</h4><p name="e5a2" id="e5a2" class="graf graf--p graf-after--h4">Componentlarımızı oluşturmak içinde styled-components kütüphanesinden faydalanacağımız için aşağıdaki kodla öncelikle yüklüyoruz.</p><p name="6379" id="6379" class="graf graf--p graf-after--p">yarn add -D styled-components @types/styled-components polished<br>or<br>npm install --save-dev styled-components @types/styled-components polished</p><p name="cfce" id="cfce" class="graf graf--p graf-after--p">Sonra src altında utils adında klasör oluşturup içinde de, colors.ts veya styles.ts adında dosyalarımızı oluşturup, aşağıda ki değişkenleri tanımlıyoruz.</p><figure name="d48d" id="d48d" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/mucahidyazar/52693ceeeeda001aee66a0b6fdb517f1.js"></script></figure><p name="4ad4" id="4ad4" class="graf graf--p graf-after--figure">Daha sonra Button.tsx klasörüne gelip yukarıda ki style.ts dosyasını tanımlıyoruz ve bu butonu export ediyoruz ve Button.tsx içinde kullanıyoruz.</p><figure name="a6ef" id="a6ef" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/mucahidyazar/43e41d2e93a27098130550fc323e3de9.js"></script></figure><p name="16e4" id="16e4" class="graf graf--p graf-after--figure">Daha sonra Button.tsx dosyamız da style.ts den gelen styled-component ile oluşturduğum Button değişkenini component gibi kullanıyorum ve defaultProps tanımlıyorum.</p><figure name="264d" id="264d" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/mucahidyazar/2aa7785b17d5cc89309e255e4189be59.js"></script></figure><h4 name="21da" id="21da" class="graf graf--h4 graf-after--figure">Step 8: prop-types</h4><p name="e824" id="e824" class="graf graf--p graf-after--h4">Prop kontrollerini aslında typescript ile zaten yapıyoruz ama birde ekstra bir kütüphane ile de yapabiliyoruz. Biz bunu da ekstradan propsları kurallandırmak, sınırlandırmak için kullanacağız. Önce aşağıdaki gibi modülü yüklüyoruz.</p><p name="684f" id="684f" class="graf graf--p graf-after--p">npm install --save-dev prop-types<br>or<br>yarn add -D prop-types</p><figure name="caf2" id="caf2" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/mucahidyazar/5965bee0d26e31d5017badee3b7a9f14.js"></script></figure><h4 name="37a5" id="37a5" class="graf graf--h4 graf-after--figure">Step 9: API Design</h4><p name="d46f" id="d46f" class="graf graf--p graf-after--h4">UI librarylerinde 2 farklı API design, tasarım şekli vardır. Birisi Traditional API yani Geleneksel API, bir diğeri Compound API yani Bileşik API. Bunlar arasında ki farklar aşağıda ki gibidir.</p><figure name="deed" id="deed" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*saaWKKfKtUaMCxnQa4_UWg.png" data-width="642" data-height="237" src="https://cdn-images-1.medium.com/max/800/1*saaWKKfKtUaMCxnQa4_UWg.png"></figure><figure name="9da3" id="9da3" class="graf graf--figure graf-after--figure"><img class="graf-image" data-image-id="1*c_WpyFCgnEh4erJMorUerA.png" data-width="642" data-height="159" src="https://cdn-images-1.medium.com/max/800/1*c_WpyFCgnEh4erJMorUerA.png"></figure><h4 name="389e" id="389e" class="graf graf--h4 graf-after--figure">Step 10: Composition API</h4><p name="093e" id="093e" class="graf graf--p graf-after--h4">Yeni nesil UI libraryleri genellikle bu yöntemi kullanmayı tercih ederler. Bu yöntem hem daha kontrol edilebilir hem de daha esnektir kullanım açısından.</p><p name="60ba" id="60ba" class="graf graf--p graf-after--p">İlk önce src altında “Field” adında bir klasör ve içinde bir style.ts dosyası oluşturup aşağıda ki kodları içinde tanımlıyoruz.</p><figure name="323c" id="323c" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/mucahidyazar/b17bbb1995ca6f786137d6194fd18673.js"></script></figure><p name="d3e0" id="d3e0" class="graf graf--p graf-after--figure">Daha sonra bu <strong class="markup--strong markup--p-strong">“Field”</strong> klasörü içinde “FieldContext” adın da bir context tutacağız. Burada createContext hooksu ile context oluşturup form alanlarında bu contextProviderını kullanacağız.</p><figure name="2010" id="2010" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/mucahidyazar/db7563bbb24b21cfe647457baf9f10a4.js"></script></figure><p name="31e9" id="31e9" class="graf graf--p graf-after--figure">Ve ayrıca bir altta ki “Field” componentımızda kullanacağımız unique id utilsini, utils klasörü altında useUniqueID.ts dosyası içinde aşağıdaki gibi oluşturuyoruz. Tabi önce bunu yapmamızı sağlayacak olan nanoid librarysini yüklüyoruz.</p><p name="17c4" id="17c4" class="graf graf--p graf-after--p">npm install --save-dev nanoid<br>or<br>yard add -D nanoid</p><figure name="b465" id="b465" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/mucahidyazar/7ab2434c0c78de351b6239c49bd0e78d.js"></script></figure><p name="3b6a" id="3b6a" class="graf graf--p graf-after--figure">Daha sonra yukarıda ki “ContextProvider”ı “Input”, “Label” gibi alanlari içine koyacağımız bir “Field.tsx” tanımlayacağız.</p><figure name="8fb8" id="8fb8" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/mucahidyazar/9f306cbb562092eb2c38f47d658c82d7.js"></script></figure><p name="0d88" id="0d88" class="graf graf--p graf-after--figure">Daha sonra “Input” ve “Label” componentlarımızı oluşturacağız.</p><figure name="e5d9" id="e5d9" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/mucahidyazar/6ffd5855b41f33a18a20c17455d4fdea.js"></script></figure><figure name="b2cf" id="b2cf" class="graf graf--figure graf--iframe graf-after--figure"><script src="https://gist.github.com/mucahidyazar/7aa173344258459bea14e7ddee20148c.js"></script></figure><p name="cc11" id="cc11" class="graf graf--p graf-after--figure">Daha sonra “Input.stories.tsx” adında yeni bir story dosyası oluşturup asağıda ki gibi “Field” ve içine gömdüğümüz “Input” ve “Label”ı çağırarak burada kullanabiliyor olacağız.</p><figure name="181d" id="181d" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/mucahidyazar/cbd9cc964c6d3fd268f50d512977bba6.js"></script></figure><p name="ee85" id="ee85" class="graf graf--p graf-after--figure">Ve son olarak da gelin yine Field klasörü altında bir diğer form elemanımız Textarea componentimizi oluşturalım.</p><figure name="5fd5" id="5fd5" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/mucahidyazar/cea3a4948f7deb1d7d022a947b7754d8.js"></script></figure><p name="0949" id="0949" class="graf graf--p graf-after--figure">Field.tsx dosyamızda da gerekli alanlara aşağdıa ki gibi Textarea’ı ekliyoruz.</p><figure name="21c2" id="21c2" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/mucahidyazar/512708c643b56e042db57bb876794d6a.js"></script></figure><p name="8f77" id="8f77" class="graf graf--p graf-after--figure">Ve son olarak da Textarea.stories.tsx dosyasını oluşturup aşağıda ki kodları gönderiyoruz.</p><figure name="9379" id="9379" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/mucahidyazar/df8397027a7f7a3571ca6c7f78587891.js"></script></figure><p name="3dff" id="3dff" class="graf graf--p graf-after--figure">Ve artık Button ve Form bileşenlerine sahip bir UI kütüphanemiz hazır diyebiliriz :)</p><h4 name="bfa6" id="bfa6" class="graf graf--h4 graf-after--p">Step 11: Tests (Jest Settings)</h4><p name="003e" id="003e" class="graf graf--p graf-after--h4">İlk önce gerekli kurulumları aşağıda ki gibi yapıyoruz.</p><p name="cb63" id="cb63" class="graf graf--p graf-after--p">npm install --save-dev jest ts-jest @types/jest react-is<br>or<br>yarn add -D jest ts-jest @types/jest react-is</p><p name="f5cb" id="f5cb" class="graf graf--p graf-after--p">Daha sonra packaga.json içinde test adında bir script oluşturacağız aşağıda ki gibi. Şuana kadar olan tüm scriptlerimizde bu kadar zaten.</p><figure name="6285" id="6285" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/mucahidyazar/6cc63e09f9045d1ba993bf390db862f5.js"></script></figure><p name="66f6" id="66f6" class="graf graf--p graf-after--figure">Daha sonra root dizininde jest.config.js adıdna dosya oluşturup aşağıda ki ayarları içine yazıyoruz.</p><figure name="cea6" id="cea6" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/mucahidyazar/14a5da61ec7c8ba3711786745927eff5.js"></script></figure><h4 name="26b8" id="26b8" class="graf graf--h4 graf-after--figure">Step 12: Tests (@testing-library/react Settings)</h4><p name="2af8" id="2af8" class="graf graf--p graf-after--h4">Yine aşağıda ki kurulumları ilk olarak gerçekleştiriyoruz.</p><p name="dfe0" id="dfe0" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">npm install --save-dev @testing-library/react @testing-library/jest-dom<br></strong>or<br><strong class="markup--strong markup--p-strong">yarn add -D @testing-library/react @testing-library/jest-dom</strong></p><p name="b062" id="b062" class="graf graf--p graf-after--p">Daha sonra <strong class="markup--strong markup--p-strong">“jest-setup.ts”</strong> adında dosya oluşturup aşağıda ki 2 importu içine gönderiyoruz. Bunlarda react testleri için styled-component uyumluluğunu ve react için jest-dom’u aktif ediyor bizim için.</p><figure name="a385" id="a385" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/mucahidyazar/1475ad602ecdc2fe72638a2300213f36.js"></script></figure><p name="ffd6" id="ffd6" class="graf graf--p graf-after--figure">tsconfig.json içine de eğer ekli değilse aşağıdaki satırı ekliyoruz.<br><strong class="markup--strong markup--p-strong"> “include”: [“src/**/*”, “./jest-setup.ts”]</strong></p><h4 name="7c3b" id="7c3b" class="graf graf--h4 graf-after--p">Step 13: Tests</h4><p name="c443" id="c443" class="graf graf--p graf-after--h4">Daha sonra yeri size kalmış ama ben Button component klasörü içinde Button.spec.ts adında bir dosya oluşturup Button componentimizin testlerini yapıyoruz.</p><figure name="0b29" id="0b29" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/mucahidyazar/ee648ff5ca9f85ad6b5937cd5b45a671.js"></script></figure><p name="b2f8" id="b2f8" class="graf graf--p graf-after--figure">Field testleri için useUniqueID adında bir mock utilse ihtiyacım olacağı için aşağıda ki gibi utils klasörü altında, __mocks__ klasörü oluşturup içinde <strong class="markup--strong markup--p-strong">“useUniqueID.ts”</strong> adında dosya oluşturup aşağıdaki mock utili oluşturuyorum.</p><figure name="28aa" id="28aa" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/mucahidyazar/1682ec5d6d2260735188fbbf6205298a.js"></script><figcaption class="imageCaption">/root/src/utils/__mocks__/useUniqueID.ts</figcaption></figure><p name="2c71" id="2c71" class="graf graf--p graf-after--figure">Daha sonrada <strong class="markup--strong markup--p-strong">“Field.spec.ts”</strong> adında test dosyamızı oluşturup aşağıda ki testleri yazıyoruz.</p><figure name="5739" id="5739" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/mucahidyazar/bae22a73dafeb16edd9d7724bec654d8.js"></script></figure><h4 name="6d88" id="6d88" class="graf graf--h4 graf-after--figure">Step 14: Module Formats</h4><p name="354c" id="354c" class="graf graf--p graf-after--h4">Bu aşamada ise oluşturduğumuz ui librarymizi babel ve @rollup librarylerini kullanıp compressleyip dist çıktısını alacağız.</p><p name="7aa6" id="7aa6" class="graf graf--p graf-after--p">Önce aşağıdaki gerekli libraryleri kuruyoruz.</p><p name="a592" id="a592" class="graf graf--p graf-after--p">npm install @babel/runtime<br>npm install --save-dev @babel/preset-env @babel/preset-typescript @babel/preset-react @babel/plugin-transform-runtime babel-plugin-styled-components<br>or<br>yarn add @babel/runtime<br>yarn add -D @babel/preset-env @babel/preset-typescript @babel/preset-react @babel/plugin-transform-runtime babel-plugin-styled-components</p><p name="264b" id="264b" class="graf graf--p graf-after--p">Şimdide .babelrc dosyası oluşturup aşağıda ki kodları yapıştırıyoruz.</p><figure name="9ded" id="9ded" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/mucahidyazar/4812fa7d227b06f7a9dff496e9ce9e54.js"></script></figure><p name="e557" id="e557" class="graf graf--p graf-after--figure">Ve şimdide rollup paketlerini yüklüyoruz. Bunlar build timeda kullanılacak paketler olduğu için devDependencies olarak ekleyebiliriz.</p><p name="3156" id="3156" class="graf graf--p graf-after--p">npm install --save-dev rollup rollup-plugin-delete rollup-plugin-node-externals @rollup/plugin-babel @rollup/plugin-commonjs @rollup/plugin-node-resolve<br>or<br>yarn add -D rollup rollup-plugin-delete rollup-plugin-node-externals @rollup/plugin-babel @rollup/plugin-commonjs @rollup/plugin-node-resolve</p><p name="d2e4" id="d2e4" class="graf graf--p graf-after--p">Ve rollup.config.js dosyası oluşturup aşağıda ki ayarları yerleştiriyoruz.</p><figure name="a497" id="a497" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/mucahidyazar/4a2b37b35b0386cba62632a9ab77081c.js"></script></figure><h4 name="ef98" id="ef98" class="graf graf--h4 graf-after--figure"><strong class="markup--strong markup--h4-strong">Step 15: Typescript Declarations</strong></h4><p name="44b3" id="44b3" class="graf graf--p graf-after--h4">Daha sonra tsconfig.build.json ayarlarımızı aşağıda ki gibi yapıyoruz.</p><p name="14bb" id="14bb" class="graf graf--p graf-after--p">Bu tanımlamalarla da index.d.ts gibi typescript rulelarını set eden dosyaları build olarak dist çıktı klasörümüze kopya olarak alacağız.</p><p name="9105" id="9105" class="graf graf--p graf-after--p">Daha sonra <strong class="markup--strong markup--p-strong">“/root/src”</strong> altında <strong class="markup--strong markup--p-strong">“index.ts”</strong> dosyası oluşturup bundle edilecek tüm dosyaları burada export ediyoruz.</p><figure name="e10e" id="e10e" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/mucahidyazar/215a6f0244c1516b2e559d21470f3dc1.js"></script></figure><p name="cf8e" id="cf8e" class="graf graf--p graf-after--figure">Daha sonra package.json dosyamıza aşağıdaki “main”, “module” ve “sideEffects” kısımlarınıda ekliyoruz ve scriptlerimizin son halide aşağıda ki gibidir.</p><figure name="0adf" id="0adf" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/mucahidyazar/43a082ed3a90603cd824efa3fec05672.js"></script></figure><p name="c7a7" id="c7a7" class="graf graf--p graf-after--figure">Ve daha sonra aşağıda ki kodları sırayla çalıştırıp kontrol edip buildi aldığımızı görüyoruz.</p><p name="7dbe" id="7dbe" class="graf graf--p graf-after--p">npm run format<br>npm run format:lint<br>npm run build</p><h4 name="e594" id="e594" class="graf graf--h4 graf-after--p">Step 16: husky</h4><p name="08a9" id="08a9" class="graf graf--p graf-after--h4">Husky ile ise githuba commit göndermeden veya pushlamadan önceki çalışması gereken actionları komut olarak vereceğiz. Örneğin her commit önceki eslint checki yapmasını istiyorum ve eğer eslint hatası varsa commiti kabul etmesini istemiyorum. İlk önce eslint hatalarını giderdikten sonra tekrar gelip commit atmasını ve tekrar denetleyerek hata yoksa commitini göndermesini istiyorum gibi.</p><p name="b2e4" id="b2e4" class="graf graf--p graf-after--p">İlk önce aşağıda ki kodla “husky”i yüklüyoruz.</p><p name="8043" id="8043" class="graf graf--p graf-after--p">npm install husky --save-dev<br>or<br>yarn add -D husky</p><p name="b179" id="b179" class="graf graf--p graf-after--p">Ve daha sorna aşağıda ki kodla git hookslarını aktif ediyoruz.<br>npx husky install</p><p name="9432" id="9432" class="graf graf--p graf-after--p">Kurulumdan sonra git hookslarını otomatik etkinleştirmek içinde aşağıda ki kodu set ediyoruz.<br>npm set-scrpit prepare “husky install”</p><p name="126e" id="126e" class="graf graf--p graf-after--p">Ve şimdi de pre-commit ile commitlerden önce çalıştırılması gereken scriptleri set ediyoruz aşağıda ki gibi.<br>npx husky add .husky/pre-commit “npm run lint &amp;&amp; npm run format:lint &amp;&amp; npm run test”</p><p name="4988" id="4988" class="graf graf--p graf-after--p">Ve şimdide push önceki olan pre-push daki kısmı ayarlıyoruz.</p><p name="802e" id="802e" class="graf graf--p graf-after--p">npx husky add .husky/pre-push “npm run lint &amp;&amp; npm run format:lint &amp;&amp; npm run test”</p><p name="c036" id="c036" class="graf graf--p graf-after--p">Ve bu kadar şimdi değişiklikleri tekrar githuba pushlayabiliriz.</p><h4 name="0815" id="0815" class="graf graf--h4 graf-after--p">Step 17: semantic-release</h4><p name="f581" id="f581" class="graf graf--p graf-after--h4">Ve artık son adımlarımızdan birisi olan semantic bir şekilde release çıkmaya geldik diyebiliriz. Burada yapacağımız ayarlarla semantic olarak version ve tag alabileceğiz, change log kayıtlarımız otomatik tutulacak ve commit mesajlarımızı daha düzgün bir şekilde tutabileceğiz.</p><p name="fb43" id="fb43" class="graf graf--p graf-after--p">İlk önce aşağıda her zaman yaptığımız gibi gerekli libraryleri yüklüyoruz.</p><p name="b4bb" id="b4bb" class="graf graf--p graf-after--p">yarn add -D semantic-release <a href="http://twitter.com/semantic" data-href="http://twitter.com/semantic" class="markup--anchor markup--p-anchor" title="Twitter profile for @semantic" rel="noopener" target="_blank">@semantic</a>-release/changelog <a href="http://twitter.com/semantic" data-href="http://twitter.com/semantic" class="markup--anchor markup--p-anchor" title="Twitter profile for @semantic" rel="noopener" target="_blank">@semantic</a>-release/git commitizen cz-conventional-changelog<br>or<br>npm install --save-dev semantic-release <a href="http://twitter.com/semantic" data-href="http://twitter.com/semantic" class="markup--anchor markup--p-anchor" title="Twitter profile for @semantic" rel="noopener" target="_blank">@semantic</a>-release/changelog <a href="http://twitter.com/semantic" data-href="http://twitter.com/semantic" class="markup--anchor markup--p-anchor" title="Twitter profile for @semantic" rel="noopener" target="_blank">@semantic</a>-release/git commitizen cz-conventional-changelog</p><p name="e075" id="e075" class="graf graf--p graf-after--p">Sonra aşağıda ki release, repository alanını ve yeni 2 scriptimizi package.jsona ekleyelim.</p><figure name="bd32" id="bd32" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/mucahidyazar/36ff4883312ec6bfe92524e83bf5e440.js"></script></figure><p name="6bad" id="6bad" class="graf graf--p graf-after--figure">Artık commitlerimizi git add yaptıktan sorna npm run commit diyerek çalıştırdıktan sonra commitizen packagenin standartlarına göre göndereceğiz. Ve pushladıktan sonra github actionslar semantic-release paketiyle birlikte automation işlemini otomatik olarak yapacak.</p><h4 name="483e" id="483e" class="graf graf--h4 graf-after--p">Step 18: Github Environment Variable</h4><p name="aacf" id="aacf" class="graf graf--p graf-after--h4">Önce Github actionslarında kullanılmak üzere ilk başta NPM_TOKEN adında bir envıronment variable tanımlamamız gerekiyor github repomuza. Bu tokeni almak için npme gidip bir tane auyomation için token oluşturuyoruz ve aşağıdaki gibi oluşturduğumuz ui librarysinin github reposunun ayarlarında ki Secret kısmında, NPM_TOKEN name olacak şekilde npmden aldığımız token ile burada yeni bir environment variable tanımlıyoruz.</p><figure name="1851" id="1851" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*tGzH7s0-wLwt7udp0ziMDA.png" data-width="642" data-height="418" src="https://cdn-images-1.medium.com/max/800/1*tGzH7s0-wLwt7udp0ziMDA.png"></figure><p name="7a62" id="7a62" class="graf graf--p graf-after--figure">Github-actionslara geçmeden önce son olarakda ui-library olan package ismimizi unique bir npm package ismi seçerek değiştiriyoruz. Npm kütüphanesine girerek seçtiğiniz paket ismini kontrol edin. Ve privateyide false yapıyoruz çünkü free npm üyeliğiyle private npm packageleri yükleyemiyoruz. Bizimkisi de free olduğu için public bir npm kütüphanesi oluşturuyoruz.</p><figure name="d731" id="d731" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/mucahidyazar/4b45901e4df754e906c070218974eafc.js"></script></figure><h4 name="6c86" id="6c86" class="graf graf--h4 graf-after--figure">Step 19: Github Actions</h4><p name="3e98" id="3e98" class="graf graf--p graf-after--h4">Ve şimdi tüm ayarlarımızı yaptığımıza göre sıra oluşturduğumuz libraryi npme publish etmeye geldi. Npm publish işini github actionslarla otomatik bir şekilde yapacağız. Süreç şu şekilde işleyecek. Biz bir commit gönderdiğimiz de yani githuba push ettiğimiz de githubda aşağıda yazdığımız ci actionu çalışıp npm release ve semantic versioning automationunu bizim için yapacak.</p><p name="92dc" id="92dc" class="graf graf--p graf-after--p">Bunun için tek yapmamız gereken aşağıdaki dizine release veya istediginiz bir dosya adı .yml şeklinde bir dosya oluşturmak ve aşağdıa ki kodları oraya yazmak. Yorumlu satırdaki test kısmını bilerek bıraktım isterseniz oradaki gibi ikinci bir job daha ekleyip kullanabilirsiniz.<br><strong class="markup--strong markup--p-strong">/root/.github/workflows/release.yml</strong></p><figure name="a940" id="a940" class="graf graf--figure graf--iframe graf-after--p graf--trailing"><script src="https://gist.github.com/mucahidyazar/8d3bce333a10a7ad5182a171de37dcc3.js"></script></figure></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@mucahidyazar" class="p-author h-card">Mucahid Yazar</a> on <a href="https://medium.com/p/3d18a41e3e27"><time class="dt-published" datetime="2021-08-06T10:25:32.172Z">August 6, 2021</time></a>.</p><p><a href="https://medium.com/@mucahidyazar/creating-a-ui-library-github-actions-rules-tests-and-version-management-3d18a41e3e27" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on November 24, 2022.</p></footer></article></body></html>