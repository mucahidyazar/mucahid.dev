<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>GraphQL ve Prisma ile REST API - Part 4 (GraphQL ve Prisma Entegrasyonu ve İlk ayarlar)</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">GraphQL ve Prisma ile REST API - Part 4 (GraphQL ve Prisma Entegrasyonu ve İlk ayarlar)</h1>
</header>
<section data-field="subtitle" class="p-summary">
yukarıdaki reponun içerisinde ki graphql-basics-starter klasörünü edinmenizi istiyorum öncelikle.
</section>
<section data-field="body" class="e-content">
<section name="c89d" class="section section--body section--first"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><p name="5e72" id="5e72" class="graf graf--p graf--leading">GraphQL ve Prisma ile REST API - Part 4 (GraphQL ve Prisma Entegrasyonu ve İlk ayarlar)</p><div name="1091" id="1091" class="graf graf--mixtapeEmbed graf-after--p"><a href="https://github.com/mucahidyazar/tutorials" data-href="https://github.com/mucahidyazar/tutorials" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://github.com/mucahidyazar/tutorials"><strong class="markup--strong markup--mixtapeEmbed-strong">mucahidyazar/tutorials</strong><br><em class="markup--em markup--mixtapeEmbed-em">Contribute to mucahidyazar/tutorials development by creating an account on GitHub.</em>github.com</a><a href="https://github.com/mucahidyazar/tutorials" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="201406308891c224f6f285b022150593" data-thumbnail-img-id="0*9Fuoc8po6bOiKcXP" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/0*9Fuoc8po6bOiKcXP);"></a></div><p name="48fc" id="48fc" class="graf graf--p graf-after--mixtapeEmbed">yukarıdaki reponun içerisinde ki graphql-basics-starter klasörünü edinmenizi istiyorum öncelikle.</p><p name="11ad" id="11ad" class="graf graf--p graf-after--p"><a href="https://mucahidyazar.medium.com/graphql-ve-prisma-ile-rest-api-c9a72d49ff39" data-href="https://mucahidyazar.medium.com/graphql-ve-prisma-ile-rest-api-c9a72d49ff39" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">https://mucahidyazar.medium.com/graphql-ve-prisma-ile-rest-api-c9a72d49ff39</a><br><a href="https://mucahidyazar.medium.com/graphql-ve-prisma-ile-rest-api-part-2-3742ba2946ed" data-href="https://mucahidyazar.medium.com/graphql-ve-prisma-ile-rest-api-part-2-3742ba2946ed" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">https://mucahidyazar.medium.com/graphql-ve-prisma-ile-rest-api-part-2-3742ba2946ed</a><br><a href="https://mucahidyazar.medium.com/graphql-ve-prisma-ile-rest-api-part-3-57e71650cced" data-href="https://mucahidyazar.medium.com/graphql-ve-prisma-ile-rest-api-part-3-57e71650cced" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">https://mucahidyazar.medium.com/graphql-ve-prisma-ile-rest-api-part-3-57e71650cced</a></p><p name="e039" id="e039" class="graf graf--p graf-after--p graf--trailing">Daha önceki serilerimde anlattığım konulardan (Yukarıdaki linklerden bakabilirsiniz) oluşturduğum basit bir GraphQL servisidir bu starter dosyamız. Biz bunu Prisma ile binding yaparak gerçek database ile iletişime geçireceğiz GraphQL serverımızı.</p></div></div></section><section name="85a0" class="section section--body"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><blockquote name="a1f6" id="a1f6" class="graf graf--blockquote graf--leading"><strong class="markup--strong markup--blockquote-strong">Prisma nedir?</strong></blockquote><p name="ece3" id="ece3" class="graf graf--p graf-after--blockquote">Prisma bir GraphQL next generation ORM’dir. Peki ORM nedir diyorsanız ORM ise Javascript gibi proğramlama dilleriyle databaselerimize erişimlerimizi kolaylaştıran sanal database gibi düşünebilirsiniz.</p><figure name="ec4a" id="ec4a" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*Hj4NTOu1eK0eWLfxl-c8oA.png" data-width="713" data-height="361" data-is-featured="true" src="https://cdn-images-1.medium.com/max/800/1*Hj4NTOu1eK0eWLfxl-c8oA.png"></figure><h3 name="1204" id="1204" class="graf graf--h3 graf-after--figure"><strong class="markup--strong markup--h3-strong">PRISMA KURULUMU</strong></h3><ul class="postList"><li name="689c" id="689c" class="graf graf--li graf-after--h3">Bu kurulumu 2 şekilde yapabiliriz. Local bir docker compose’u oluşturabilir ve heroku postgresql databasesi üzerinde tutarız. Veya prismanın kendi sunucusunda docker composemizi kurup heroku postgresql databasesinde verilerimizi tutarız. 1. yöntem genelde development denemeleri için kullanılır. 2. yöntem ise daha çok productiona geçileceği zaman kullanılır. Ben size 2 sinide göstereceğim.</li></ul><blockquote name="fe6c" id="fe6c" class="graf graf--blockquote graf-after--li"><strong class="markup--strong markup--blockquote-strong">LOCAL DOCKER ve HEROKU POSTGRESQL DATABASE for DEVELOPMENT</strong></blockquote><p name="f87f" id="f87f" class="graf graf--p graf-after--blockquote"><strong class="markup--strong markup--p-strong">Adım 1:</strong> Herokuya girip yeni proje oluşturuyoruz.</p><figure name="a1bf" id="a1bf" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*CI576X3T1jxLwAIZTIiQ5Q.png" data-width="400" data-height="196" src="https://cdn-images-1.medium.com/max/800/1*CI576X3T1jxLwAIZTIiQ5Q.png"></figure><p name="b9af" id="b9af" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">Adım 2:</strong> Resources kısmında ki Add-ons kısmında Heroku Postgres ‘i bul ve kur.</p><figure name="ef4b" id="ef4b" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*YleDIm8NPb0U9QS8jFVX5g.png" data-width="501" data-height="58" src="https://cdn-images-1.medium.com/max/800/1*YleDIm8NPb0U9QS8jFVX5g.png"></figure><figure name="1bc9" id="1bc9" class="graf graf--figure graf-after--figure"><img class="graf-image" data-image-id="1*rDuWuyklb8QWBXdEJEls7A.png" data-width="737" data-height="88" src="https://cdn-images-1.medium.com/max/800/1*rDuWuyklb8QWBXdEJEls7A.png"></figure><figure name="c655" id="c655" class="graf graf--figure graf-after--figure"><img class="graf-image" data-image-id="1*43_G_v1F5k6RND8M6mhQrg.png" data-width="237" data-height="253" src="https://cdn-images-1.medium.com/max/800/1*43_G_v1F5k6RND8M6mhQrg.png"></figure><p name="c93e" id="c93e" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">Adım 3:</strong> Yukarıda ki kısımları tamamlayıp Heroku Postgres’i kurduktan sonra içeri girip settings kısmına gelip, Database Credentials kısmında ki bilgiler sayfasını açalım.</p><figure name="a7c9" id="a7c9" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*RV4v51p6iIZeVkdsGb5QXg.png" data-width="739" data-height="470" src="https://cdn-images-1.medium.com/max/800/1*RV4v51p6iIZeVkdsGb5QXg.png"></figure><p name="d637" id="d637" class="graf graf--p graf-after--figure"><a href="https://www.pgadmin.org/download/" data-href="https://www.pgadmin.org/download/" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">https://www.pgadmin.org/download/</a></p><p name="ba83" id="ba83" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">Adım 4:</strong> Daha sonra yüklü değilse yukarıdaki linkten Postgres GUI arayüz gösterme uygulaması pgadmin uygulamasını indirelim ve açalım.</p><p name="505e" id="505e" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">Adım 5:</strong> Bize tarayıcıda bir pencere acacak ve ilk olarak create a new server diyeceğiz.</p><figure name="d257" id="d257" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*N3RbvzuQolJTS-rpYFubXg.png" data-width="457" data-height="370" src="https://cdn-images-1.medium.com/max/800/1*N3RbvzuQolJTS-rpYFubXg.png"></figure><p name="94bb" id="94bb" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">Adım 6:</strong> Database Credentials kısmında ki bilgileri bu sayfada ki new database oluşturma penceresinde ki Connection sekmesinde ki boşluklara giriyoruz ve SAVE yapıyoruz.</p><figure name="75c1" id="75c1" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*RZVCdLQE3YwyNXRIzFRFqw.png" data-width="358" data-height="395" src="https://cdn-images-1.medium.com/max/800/1*RZVCdLQE3YwyNXRIzFRFqw.png"></figure><p name="619c" id="619c" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">Adım 7:</strong> Daha sonra Databases kısmından database namemizi aratarak oluşturduğumuz databasemizi buluyoruz.</p><figure name="eb3c" id="eb3c" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*46nA0Fu6NXlQVzVx1DnamQ.png" data-width="509" data-height="367" src="https://cdn-images-1.medium.com/max/800/1*46nA0Fu6NXlQVzVx1DnamQ.png"></figure><p name="7db5" id="7db5" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">Adım 8:</strong> Şimdi de Docker Desktop Windows’u yüklüyoruz.</p><p name="5d80" id="5d80" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">Adım 12:</strong> Daha sonra Docker Desktopun açık olduğundan emin olduktan sonra, terminalde aşağıda ki kodu çalıştırarak Docker containerımızı çalıştırıyoruz. Bunu çok detaylı bilip anlamamıza gerek yok.</p><p name="bbe9" id="bbe9" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">docker-compose up -d</strong></p><blockquote name="df63" id="df63" class="graf graf--blockquote graf-after--p"><strong class="markup--strong markup--blockquote-strong">PRISMA SERVER and HEROKU DATABASE SERVICE for PRODUCTION</strong></blockquote><ul class="postList"><li name="c94e" id="c94e" class="graf graf--li graf-after--blockquote">Burada ise bir yerden sonra aslında yukarıdaki işlemlerin aynısını yapacağız. Ama docker compose işlemini burada Prisma kendi serverında bizim için yapacak.</li></ul><div name="7937" id="7937" class="graf graf--mixtapeEmbed graf-after--li"><a href="https://app.prisma.io/login" data-href="https://app.prisma.io/login" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://app.prisma.io/login"><strong class="markup--strong markup--mixtapeEmbed-strong">Prisma 1 Console</strong><br><em class="markup--em markup--mixtapeEmbed-em">Edit description</em>app.prisma.io</a><a href="https://app.prisma.io/login" class="js-mixtapeImage mixtapeImage mixtapeImage--empty u-ignoreBlock" data-media-id="560551096b28f62caa329b57b3cc0a16"></a></div><p name="f401" id="f401" class="graf graf--p graf-after--mixtapeEmbed"><strong class="markup--strong markup--p-strong">Adım 1:</strong> Yukarıda ki adrese gidip prisma servisimizi kuracağımız prisma cloud’a kayıt olup giriş yapıyoruz.</p><p name="7193" id="7193" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">Adım 2:</strong> ADD SERVER</p><figure name="fe08" id="fe08" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*6PeS_dL97oLJ59CbZDw8nA.png" data-width="711" data-height="281" src="https://cdn-images-1.medium.com/max/800/1*6PeS_dL97oLJ59CbZDw8nA.png"></figure><p name="05ee" id="05ee" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">Adım 3: </strong>Dolduruyoruz ve CREATE A SERVER</p><figure name="032b" id="032b" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*M2UrZ9IzTsPMF1qnmfmLiw.png" data-width="344" data-height="322" src="https://cdn-images-1.medium.com/max/800/1*M2UrZ9IzTsPMF1qnmfmLiw.png"></figure><p name="e623" id="e623" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">Adım 4:</strong> CREATE A NEW DATABASE</p><figure name="7615" id="7615" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*1MtuMRKRctDu3zUp9WPg7Q.png" data-width="398" data-height="147" src="https://cdn-images-1.medium.com/max/800/1*1MtuMRKRctDu3zUp9WPg7Q.png"></figure><p name="406f" id="406f" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">Adım 5:</strong> Herokuyu seçiyoruz.</p><figure name="fe77" id="fe77" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*CIkD6e0rZqWMcVVYcUFMoQ.png" data-width="379" data-height="197" src="https://cdn-images-1.medium.com/max/800/1*CIkD6e0rZqWMcVVYcUFMoQ.png"></figure><p name="c1e1" id="c1e1" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">Adım 6:</strong> Herokuya bağlanıyoruz.</p><figure name="42e0" id="42e0" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*40NZTOxpbb30qKe24qoWvQ.png" data-width="337" data-height="286" src="https://cdn-images-1.medium.com/max/800/1*40NZTOxpbb30qKe24qoWvQ.png"></figure><p name="9af9" id="9af9" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">Adım 7:</strong> Herokuda bir database servisi alıyoruz. Ben ücretsiz olanını ediniyorum. Ve CREATE DATABASE</p><figure name="27d0" id="27d0" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*Glho5vi0cSaLgPKnrdGN8A.png" data-width="383" data-height="549" src="https://cdn-images-1.medium.com/max/800/1*Glho5vi0cSaLgPKnrdGN8A.png"></figure><p name="b574" id="b574" class="graf graf--p graf-after--figure">Artık postgreSQL ile çalışacak serverımızı ayarladık. Şimdi de docker compose işlemini yapacak serverımızı ayarlıyoruz.</p><p name="9292" id="9292" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">Adım 8:</strong> SET UP A SERVER</p><figure name="01ee" id="01ee" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*bt23tYqxHSwGr5X91AgM9A.png" data-width="341" data-height="399" src="https://cdn-images-1.medium.com/max/800/1*bt23tYqxHSwGr5X91AgM9A.png"></figure><p name="335f" id="335f" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">Adım 9:</strong> HEROKU</p><figure name="6638" id="6638" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*PAYboyBVcfGRfTX_9cLIQA.png" data-width="287" data-height="246" src="https://cdn-images-1.medium.com/max/800/1*PAYboyBVcfGRfTX_9cLIQA.png"></figure><p name="a313" id="a313" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">Adım 10:</strong> CREATE A SERVER</p><figure name="b6a7" id="b6a7" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*9FDDizbIKn9c3EmTH61C-g.png" data-width="290" data-height="336" src="https://cdn-images-1.medium.com/max/800/1*9FDDizbIKn9c3EmTH61C-g.png"></figure><p name="13c6" id="13c6" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">Adım 11:</strong> VIEW THE SERVER</p><figure name="32dd" id="32dd" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*K46qCap2IlilrYpmQaRo3w.png" data-width="293" data-height="268" src="https://cdn-images-1.medium.com/max/800/1*K46qCap2IlilrYpmQaRo3w.png"></figure><p name="9d4b" id="9d4b" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">Adım 12:</strong></p><ul class="postList"><li name="2ea0" id="2ea0" class="graf graf--li graf-after--p">Buradaki server bizim prisma-docker containerimizi calistiracak.</li><li name="df37" id="df37" class="graf graf--li graf-after--li">Database ise Production databasemizi calistiracak.</li></ul><figure name="be57" id="be57" class="graf graf--figure graf-after--li"><img class="graf-image" data-image-id="1*8ptzAWafwg11kGCWYu1jTw.png" data-width="304" data-height="489" src="https://cdn-images-1.medium.com/max/800/1*8ptzAWafwg11kGCWYu1jTw.png"></figure><p name="960c" id="960c" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">Adım 13:</strong> Database’ye tıklayip oluşturulmuş yeni heroku servisimize gideceğiz ve oradan asağıda ki gibi Installed Addonstaki Heroku Postgress’e tıklayarak sayfayı aciyoruz.</p><figure name="c2c1" id="c2c1" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*WFUVhWDyl5Lwh_ERe8dh1g.png" data-width="454" data-height="218" src="https://cdn-images-1.medium.com/max/800/1*WFUVhWDyl5Lwh_ERe8dh1g.png"></figure><p name="ddf5" id="ddf5" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">Adım 14:</strong> Ve development serverımızı oluştururken yaptığımız gibi buradan settings’e gidip Credentials bilgilerini alip pgAdminden asagidaki gibi yeni production serverımızı kuruyoruz.</p><figure name="8042" id="8042" class="graf graf--figure graf-after--p graf--trailing"><img class="graf-image" data-image-id="1*L02MYbNfmcKpHSQS8Dp1gA.png" data-width="342" data-height="364" src="https://cdn-images-1.medium.com/max/800/1*L02MYbNfmcKpHSQS8Dp1gA.png"></figure></div></div></section><section name="f52e" class="section section--body section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><p name="ce00" id="ce00" class="graf graf--p graf--leading">Şimdi oluşturduğumuz bu servisleri graphQL ile entergre etme adımına geldik. Yukarıdaki 2 yöntemden birini yaparak sona kadar geldiğinizde ve elinizde database credentials bilgileri bulunduğunu varsayıyorum ve bir sonra ki aşamayı anlatmaya devam ediyorum.</p><p name="a4d1" id="a4d1" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">Adım 1:</strong> Aşağıdaki kod ile prisma’yı GLOBAL olarak yüklüyoruz.</p><p name="3d0d" id="3d0d" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">npm install -g prisma</strong></p><p name="b8b5" id="b8b5" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">Adım 2: </strong>Daha sonra indirdiğimiz repodaki graphql-prisma-starter klasörünün içine geliyoruz. Root dizinimize gelip aşağıda ki kodu çalıştırarak prisma initialization’u başlatıyoruz. (İlk başta ki prisma ile yukarıda yüklediğimiz prismaya erişiyoruz ve init komutunu veriyoruz. ikinci prisma ise prisma servisimizin adı ve içinde olacağı klasör ismini belirliyoruz.)</p><p name="4ddd" id="4ddd" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">prisma init prisma</strong></p><p name="76c2" id="76c2" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">Adım 3:</strong> Ve burada bize bazı sorular soracak. Burada gerekli yerlere oluşturduğumuz yukarıda ki servislerden elde ettiğimiz database bilgilerini yazarken diğer kalanları için benim gibi aşağıdaki seçeneklerle ilerleyin şimdilik daha sonra siz diğerlerini denersiniz.</p><p name="0212" id="0212" class="graf graf--p graf-after--p">Set up a new Prisma server or deploy to an existing server? <br><strong class="markup--strong markup--p-strong">Use existing database</strong></p><p name="13ba" id="13ba" class="graf graf--p graf-after--p">What kind of database do you want to deploy to?<br><strong class="markup--strong markup--p-strong">PostgreSQL</strong></p><p name="5dfd" id="5dfd" class="graf graf--p graf-after--p">Does your database contain existing data? <br><strong class="markup--strong markup--p-strong">No</strong> (Çünkü elimizde yedeklenmiş bir database datası yok olsaydı onlarla birlikte kullanabilirdik.)</p><p name="6a48" id="6a48" class="graf graf--p graf-after--p">Enter database host <br><strong class="markup--strong markup--p-strong">ec2–176–34–114–78.eu-west-1.compute.amazonaws.com</strong> <br>(Burada ise herokuda olusturdugumuz ucretsiz databasenin credential informations da bulunan <strong class="markup--strong markup--p-strong">hostunu</strong> yazıyoruz.)</p><p name="09e9" id="09e9" class="graf graf--p graf-after--p">Enter database port <br><strong class="markup--strong markup--p-strong">5432</strong> <br>(Burada ise herokuda oluşturduğumuz ücretsiz databasenin credential informations da bulunan <strong class="markup--strong markup--p-strong">portunu</strong> yazıyoruz.)</p><p name="1647" id="1647" class="graf graf--p graf-after--p">Enter database user<br><strong class="markup--strong markup--p-strong">zzlimvlciyrewy</strong> <br>(Burada ise herokuda oluşturduğumuz ücretsiz databasenin credential informations da bulunan <strong class="markup--strong markup--p-strong">user </strong>kismini yazıyoruz.)</p><p name="259e" id="259e" class="graf graf--p graf-after--p">Enter database password<br><strong class="markup--strong markup--p-strong">[hidden]</strong> <br>(Burada ise herokuda oluşturduğumuz ücretsiz databasenin credential informations da bulunan <strong class="markup--strong markup--p-strong">Password </strong>kısmını yazıyoruz.)</p><p name="f90e" id="f90e" class="graf graf--p graf-after--p">Enter database name (the database includes the schema) <br><strong class="markup--strong markup--p-strong">dfm7njqompn05g</strong> <br>(Burada ise herokuda oluşturduğumuz ücretsiz databasenin credential informations da bulunan <strong class="markup--strong markup--p-strong">database </strong>kısmını yazıyoruz.)</p><p name="7a2a" id="7a2a" class="graf graf--p graf-after--p">Use SSL? <br><strong class="markup--strong markup--p-strong">Yes</strong> <br>(Heroku da SSL oldugu icin buraya <strong class="markup--strong markup--p-strong">Yes</strong> diyoruz)</p><p name="73ca" id="73ca" class="graf graf--p graf-after--p">Select the programming language for the generated Prisma client <br><strong class="markup--strong markup--p-strong">Don’t generate</strong> <br>(Herhangi boilerplate’ye ihtiyacımız olmadığı için dont generate yapıyoruz.)</p><p name="988c" id="988c" class="graf graf--p graf-after--p">Ve bitti. Bu bize 3 dosya oluşturacak prisma klasörü altında aşagıda ki gibi.</p><figure name="fd0a" id="fd0a" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*j22-2RXX-450QS0aq0ejHw.png" data-width="235" data-height="146" src="https://cdn-images-1.medium.com/max/800/1*j22-2RXX-450QS0aq0ejHw.png"></figure><p name="9d0f" id="9d0f" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">Datamodel.prisma</strong> =&gt; Bizim schema.graphql ile aynısıdır, hiçbir farkı yoktur sadece prisma icin type definitionlarimizi tanımlariz burada. Prisma bunu kullanarak herhangi bir seçtiğimiz database için database structuremızı kurar ve hazırlar bizim için.</p><p name="3561" id="3561" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">Prisma.yml</strong> =&gt; prisma’ya ait default ayarlar burada bulunur.</p><p name="f014" id="f014" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">Docker-compose.yml</strong> =&gt; Burada ise docker servisleri ve database ayarlarına ait ayarlar bulunur.</p><p name="b2ac" id="b2ac" class="graf graf--p graf-after--p">Adım 4: datamodel.prisma’nın adını datamodel.graphql yapıyoruz. ve prisma.yml icindede <strong class="markup--strong markup--p-strong">datamadel: datamodel.graphql </strong>yapiyoruz.</p><blockquote name="b3d9" id="b3d9" class="graf graf--blockquote graf-after--p"><strong class="markup--strong markup--blockquote-strong">ÖNEMLİ AYARLAR</strong></blockquote><p name="12a0" id="12a0" class="graf graf--p graf-after--blockquote"><strong class="markup--strong markup--p-strong">generated.graphql</strong></p><p name="4e24" id="4e24" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">Adım 5:</strong> Her <strong class="markup--strong markup--p-strong">prisma deploy</strong> işlemini yaptıktan sonra otomatik generated.graphql dosyamızın oluşması için aşağıdaki prisma hooksunu prisma.yml içine ekliyoruz. (Bu generated.graphql dosyası bizim prismada oluşturduğumuz databasede yapacaklarımız Query Mutation işlemlerinin hepsini barındıran, datamode.graphql içinde olan type lara göre oluşturulmuş .graphql dosyasıdır.)</p><figure name="98e7" id="98e7" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/mucahidyazar/7fff66b116bb5399abd2506e2a46adc4.js"></script></figure><p name="1c60" id="1c60" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">Environment Variables</strong></p><p name="6970" id="6970" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">Adım 6:</strong></p><ul class="postList"><li name="56ab" id="56ab" class="graf graf--li graf-after--p">Aşağıdaki npm modülünü yüklüyoruz.</li></ul><p name="95e8" id="95e8" class="graf graf--p graf-after--li"><strong class="markup--strong markup--p-strong">npm install env-cmd --save-dev</strong></p><ul class="postList"><li name="eba3" id="eba3" class="graf graf--li graf-after--p">root dizininde config klasörü ve içinde env klasörü oluşturuyoruz. Ve env klasörü içinde 3 tane dev.env-test.env-prod.env adında 3 dosya oluşturuyoruz. Ve örnek olarak ben dev.env’yi aşağıdaki şekilde ki gibi ayarlıyorum.</li></ul><figure name="c140" id="c140" class="graf graf--figure graf--iframe graf-after--li"><script src="https://gist.github.com/mucahidyazar/14ad1d7fa572595d3474b30def920d95.js"></script></figure><ul class="postList"><li name="1556" id="1556" class="graf graf--li graf-after--figure">Şimdide prisma klasöründe ki prisma.yml dosyasını aşağıda ki gibi oluşturduğum environment variable’ı dahil ediyorum.</li></ul><figure name="5760" id="5760" class="graf graf--figure graf--iframe graf-after--li"><script src="https://gist.github.com/mucahidyazar/c869c464434a37bf05cd928f79d33237.js"></script></figure><p name="d46e" id="d46e" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">Adım 7: </strong>prisma deploy yapmadan önce son olarak package.json’daki dev scriptini aşağıdaki gibi ayarlıyorum ki environment variablelarım çalıştırıldığında nodejs bunları görsün ve kullandığımız yerlerde tanısın.</p><figure name="13ae" id="13ae" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/mucahidyazar/cd4740c36bb55b1fd9b8655976574df7.js"></script></figure><p name="8bc5" id="8bc5" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">Adım 8:</strong> Daha sonra oluşturduğum tüm prisma klasörüne geliyoruz terminalde ve aşağıda ki kodu çalıştırıyoruz.</p><p name="344d" id="344d" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">prisma deploy</strong></p><p name="5d97" id="5d97" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">Adım 9:</strong></p><ul class="postList"><li name="4bd0" id="4bd0" class="graf graf--li graf-after--p">Daha sonra aşağıda ki ekran gibi bir ekran sonucu almalıyız. Aşağıda çıkan 2 tane uyarılara aldırmıyoruz. Sonra diğer 3 tane soruyu cevaplıyoruz. Burada prisma.io üzerindeki sunucumuz üzerinde servisimizi ayağa kaldırıyoruz.</li></ul><figure name="77ee" id="77ee" class="graf graf--figure graf-after--li"><img class="graf-image" data-image-id="1*ipxRCq6X2aoBff5X1XbVkw.png" data-width="742" data-height="1022" src="https://cdn-images-1.medium.com/max/800/1*ipxRCq6X2aoBff5X1XbVkw.png"></figure><ul class="postList"><li name="dc17" id="dc17" class="graf graf--li graf-after--figure">Ve sizinde farkedeceğiniz üzere prisma.yml aşağıdaki gibi olmuş olacak. Bizin environment yazısı yorum olmuş.</li></ul><figure name="e690" id="e690" class="graf graf--figure graf-after--li"><img class="graf-image" data-image-id="1*xpyl5rOxwTNAV6Y1p2jd0g.png" data-width="731" data-height="143" src="https://cdn-images-1.medium.com/max/800/1*xpyl5rOxwTNAV6Y1p2jd0g.png"></figure><ul class="postList"><li name="2215" id="2215" class="graf graf--li graf-after--figure">Biz buradaki yeni linkimizi alıp dev.env’ye gidip PRISMA endpointe veriyoruz ve prisma.yml içindeki endpointide silip eski environment ile çalışan endpoint: <strong class="markup--strong markup--li-strong">${env:PRISMA_ENDPOINT}</strong> yapıyoruz tekrardan.</li></ul><p name="e486" id="e486" class="graf graf--p graf-after--li"><strong class="markup--strong markup--p-strong">Adım 10:</strong> prisma deploy işlemini yapmadan önce datamodel.graphql dosyasına gelip aşağıdaki mock User type’ını ekleyelim. Buraya daha sonra graphql servisimizde oluşturduğumuz typeları ekleyeceğiz.</p><figure name="c5b8" id="c5b8" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/mucahidyazar/355061f927c789629523f9b6ac672335.js"></script></figure><p name="ada6" id="ada6" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">Adım 11:</strong> Artık deploy işlemimizi environment variable a göre aşağıda ki gibi yapabiliriz.</p><p name="a10f" id="a10f" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">prisma1 deploy -e ../config/env/prod.env</strong></p><p name="40ae" id="40ae" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">Adım 12:</strong> Artık endpoınt envıronment variable tanımladığımız adrese gittiğimizde aşağıdaki görüntüdeki gibi bir playground ile karşılacağız.</p><figure name="390f" id="390f" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*Hf9Nstsf8s9Q84HYLXR9hg.png" data-width="716" data-height="348" src="https://cdn-images-1.medium.com/max/800/1*Hf9Nstsf8s9Q84HYLXR9hg.png"></figure><blockquote name="a7cb" id="a7cb" class="graf graf--blockquote graf-after--figure"><strong class="markup--strong markup--blockquote-strong">Prisma-GraphQL Servisimizi Dışarıya Kapatmak</strong></blockquote><p name="8e04" id="8e04" class="graf graf--p graf-after--blockquote"><strong class="markup--strong markup--p-strong">Adım 13:</strong></p><ul class="postList"><li name="d433" id="d433" class="graf graf--li graf-after--p">Prisma servisimize direk olarak clientlarin ulaşamaması için servisimizi dış dünyaya kapatmalıyız. GraphQL servisimiz ise Prisma ile belirleyecegimiz bir sifre ile haberlesmesini saglayacagiz.</li><li name="bca9" id="bca9" class="graf graf--li graf-after--li">Yani açıklık getirmek gerekirse. Artık elimizde 2 tane GraphQL playground olacak. Bunlardan birincisi bizim elimizle kendi mutation ve querylerimizi yazdığımız GraphQL servisi ve bir diğeride Prismaya deploy ederek Prismanın bu deploy işlemi ile bize oluşturduğu GraphQL servisi var. Client side tarafı bu prismanın bize oluşturduğu GraphQL servisi ile haberleşmeyecek. Biz Kendi GraphQL servisimizle, prismanın bizim için oluşturduğu bu GraphQL servisi ile haberleşeceğiz ve Clientside tarafıda bizim GraphQL servisimizde yazdığımız Mutation ve Querylerle haberleşerek çalışacak.</li><li name="0c9f" id="0c9f" class="graf graf--li graf-after--li">Tabi biz Prisma GraphQL servisine bir secret key belirleyeceğiz ve bizim GraphQL servisimiz bu keyi Prismanın GraphQL servisine vererek haberleşecek. Browserdan bu servise ulaşmak istersek isek bizde prisma servisimizden alacağımız bir token ile Prisma GraphQL servisimize browserdan manuel olarakda erişebileceğiz zaten.</li></ul><figure name="0fab" id="0fab" class="graf graf--figure graf-after--li"><img class="graf-image" data-image-id="1*6Q6PTfJmXVyArGjh7aovXA.png" data-width="744" data-height="208" src="https://cdn-images-1.medium.com/max/800/1*6Q6PTfJmXVyArGjh7aovXA.png"></figure><ul class="postList"><li name="a105" id="a105" class="graf graf--li graf-after--figure">Prisma servisimizin dosyalarının olduğu yerde ki prisma.yml dosyasının içine gelip aşağıda ki gibi secret key belirliyoruz. Ben önce environment variable a ekledim secret keyimi sonra prisma.yml içinde aşağıdaki gibi kullandım.</li></ul><figure name="463f" id="463f" class="graf graf--figure graf--iframe graf-after--li"><script src="https://gist.github.com/mucahidyazar/db0ffa7fbc1f711f34e5fb9e14850fa5.js"></script></figure><ul class="postList"><li name="11d1" id="11d1" class="graf graf--li graf-after--figure">Ve prisma klasor dizinimize terminalden gelip <strong class="markup--strong markup--li-strong">prisma deploy</strong> komutunu calıştırarak secret keyimizi prismaya gönderiyoruz.</li><li name="28f1" id="28f1" class="graf graf--li graf-after--li">Ve artın endpoınte gittiğinizde göreceksiniz ki Prisma servisiniz GraphQL playgrounduna erişemiyorsunuz.</li></ul><p name="43ac" id="43ac" class="graf graf--p graf-after--li"><strong class="markup--strong markup--p-strong">PRİSMA TOKEN</strong></p><ul class="postList"><li name="a3f8" id="a3f8" class="graf graf--li graf-after--p">Browserdan prisma playgrounda erişebilmek için prisma token almamız gerekiyor ve bu prisma tokenı Prisma Graphql playgrounduna http headers kısmında Authorızation’a başına bearer yazıp göndermemiz gerekiyor.</li><li name="5079" id="5079" class="graf graf--li graf-after--li">Aşağıdaki kod ile tokenimızı resimdeki gibi alıyoruz.</li></ul><p name="28e2" id="28e2" class="graf graf--p graf-after--li"><strong class="markup--strong markup--p-strong">prisma1 token -e ../config/env/dev.env</strong></p><figure name="5024" id="5024" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*K8gEmmXWZG9qA_Gg24LNyA.png" data-width="732" data-height="49" src="https://cdn-images-1.medium.com/max/800/1*K8gEmmXWZG9qA_Gg24LNyA.png"></figure><ul class="postList"><li name="d562" id="d562" class="graf graf--li graf-after--figure">Daha sonra bu tokenı playgroundumuz altında bulunan <strong class="markup--strong markup--li-strong">HTTP HEADERS’a</strong> girip <strong class="markup--strong markup--li-strong">Authorization’a</strong> <strong class="markup--strong markup--li-strong">Bearer</strong> diyip yanına <strong class="markup--strong markup--li-strong">tokenı</strong> yapıştırıp aşağıda ki gibi tanımlamamız gerekiyor. Ve artık prisma playgrounduda şifreli kullanabiliyor olacağız.</li></ul><figure name="7dbb" id="7dbb" class="graf graf--figure graf-after--li"><img class="graf-image" data-image-id="1*omMtIfMETKVgELv1JOlDgQ.png" data-width="664" data-height="126" src="https://cdn-images-1.medium.com/max/800/1*omMtIfMETKVgELv1JOlDgQ.png"></figure><p name="aff1" id="aff1" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">PRİSMA DELETE</strong></p><ul class="postList"><li name="6779" id="6779" class="graf graf--li graf-after--p">Diyelim ki User alanına yeni bir nullable alan ekledik, diğer önce ki datalarda bu yeni alan olmayacağı için prisma deploy başarısız olacaktır. O yüzden burada once delete yaparak tüm dataları temizliyoruz ve daha sonra password alanı ekliyoruz ve deploy edebiliriz artık.</li></ul><blockquote name="6555" id="6555" class="graf graf--blockquote graf-after--li">PRİSMA ve GRAPHQL SERVİSİNİ BAĞLAMAK</blockquote><p name="f7ce" id="f7ce" class="graf graf--p graf-after--blockquote"><strong class="markup--strong markup--p-strong">Adım 14: PRISMA-BINDING</strong></p><p name="5363" id="5363" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">npm install prisma-binding</strong></p><ul class="postList"><li name="4306" id="4306" class="graf graf--li graf-after--p">Ve artık prisma servisimizi ve bizim nodejs ile oluşturduğumuz graphql servisimizi, prisma-binding kütüphanesi ile birbirine bağlayabiliriz.</li><li name="6eb5" id="6eb5" class="graf graf--li graf-after--li">src dizini altında prisma.js adında dosyamızı oluşturup içine aşağıdaki kodları yazıyoruz.</li></ul><figure name="5976" id="5976" class="graf graf--figure graf--iframe graf-after--li"><script src="https://gist.github.com/mucahidyazar/876cc60bab9015024588ec97a39bbb37.js"></script></figure><ul class="postList"><li name="251f" id="251f" class="graf graf--li graf-after--figure">Prisma objesini prisma-binding kütüphanesi içinde alarak import ediyoruz. Ve daha sonra bunu bir değişkene atarak new ile Prisma oluşturuyoruz.</li><li name="d21d" id="d21d" class="graf graf--li graf-after--li">typeDefs propertysine prisma deploy işlemleri sonrası belirlediğimiz yoldaki generated klasörü içinde oluşan prisma.graphql dosyasının yolunu veriyoruz.</li><li name="02ba" id="02ba" class="graf graf--li graf-after--li">endpoint olarak environment variabledaki endpointimizi veriyoruz.</li><li name="660c" id="660c" class="graf graf--li graf-after--li">secret olarakda Nodejs GraphQL servisimizin Prisma’ya koyduğumuz secret keyi tanıması ve bilmesi daha sonrada prisma GraphQL servisine söylemesi için environment variable’daki oluşturduğumuz secret keyi veriyoruz.</li><li name="cd7f" id="cd7f" class="graf graf--li graf-after--li">Daha sonra index.js dosyamıza gelip bu oluşturduğumuz prisma.js dosyasını import ediyoruz ve GraphQL servisimize context olarak aşağıdaki gibi veriyoruz.</li></ul><figure name="8b64" id="8b64" class="graf graf--figure graf--iframe graf-after--li"><script src="https://gist.github.com/mucahidyazar/6d7635de5bd96edf95610222e7ef98ca.js"></script></figure><ul class="postList"><li name="1981" id="1981" class="graf graf--li graf-after--figure">Ve artık GraphQL servisimizde oluşturacağımız Query ve Mutationlarda bu prismayı contextden yakalayıp GraphQL servisimiz içinden prisma servisine bağlanarak istediğimiz Query ve Mutationları oluşturabileceğiz.</li></ul><p name="2e24" id="2e24" class="graf graf--p graf-after--li"><strong class="markup--strong markup--p-strong">Adım 15: FINAL</strong></p><ul class="postList"><li name="6526" id="6526" class="graf graf--li graf-after--p">Ve gelin son olarak oluşturduğumuz bu projeyle, GraphQL servisine bir mutation yazalım ve prismaya bağlanıp bir User oluşturalım.</li><li name="231d" id="231d" class="graf graf--li graf-after--li">Once schema.graphql dosyasina gelip aşağıdaki gibi bir mutation ve bu mutation için basit bir input oluşturuyoruz.</li></ul><figure name="4186" id="4186" class="graf graf--figure graf--iframe graf-after--li"><script src="https://gist.github.com/mucahidyazar/5b08d17b017ca23bf45ea8911f96f4b7.js"></script></figure><ul class="postList"><li name="c2d2" id="c2d2" class="graf graf--li graf-after--figure">Ve daha sonra resolver içindeki Mutation.js dosyasına gelip aşağıda ki mutationu oluşturuyoruz.</li></ul><figure name="4b79" id="4b79" class="graf graf--figure graf--iframe graf-after--li"><script src="https://gist.github.com/mucahidyazar/411f7a9903678c5f68afae9144dd7fdc.js"></script></figure><ul class="postList"><li name="8615" id="8615" class="graf graf--li graf-after--figure">Ve daha sonra localhostteki graphql servisimize gelip aşağıdaki mutationumuzu çalıştırdığımızda prismaya bağlanıp databasemize kaydettiğimiz ilk userımızı oluşturmuş olacağız. :)</li></ul><figure name="87c0" id="87c0" class="graf graf--figure graf-after--li"><img class="graf-image" data-image-id="1*0fX4u3yCFcioDJ7qQ-7hXQ.png" data-width="713" data-height="372" src="https://cdn-images-1.medium.com/max/800/1*0fX4u3yCFcioDJ7qQ-7hXQ.png"></figure><p name="12a4" id="12a4" class="graf graf--p graf-after--figure graf--trailing">Şimdilik bu kadar. Bu GraphQL ve pisma servislerimizi bağladığımız ve gerekli konfigrasyon ayarlarını yaptığımız bir yazı serisiydi. Bir sonraki serimde ise Prisma ile yapabileceğimiz ve rest api ımızı şekillendireceğimiz işlemleri yapacağız. Şimdilik hoşçakalın.</p></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@mucahidyazar" class="p-author h-card">Mucahid Yazar</a> on <a href="https://medium.com/p/a272b06a0159"><time class="dt-published" datetime="2021-01-22T05:14:51.979Z">January 22, 2021</time></a>.</p><p><a href="https://medium.com/@mucahidyazar/graphql-ve-prisma-ile-rest-api-part-4-graphql-ve-prisma-entegrasyonu-ve-i%CC%87lk-ayarlar-a272b06a0159" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on November 24, 2022.</p></footer></article></body></html>